// Bubble creation
const bubblesContainer = document.getElementById('bubbles');
for(let i=0; i<20; i++){
  let bubble = document.createElement('div');
  bubble.classList.add('bubble');
  bubble.style.left = Math.random()*100 + '%';
  bubble.style.width = (5 + Math.random()*10)+'px';
  bubble.style.height = bubble.style.width;
  bubble.style.animationDuration = (4 + Math.random()*4)+'s';
  bubblesContainer.appendChild(bubble);
}

// Prediction simulation
const imageUpload = document.getElementById('imageUpload');
const predictionDiv = document.getElementById('prediction');
const contributeBtn = document.getElementById('contributeBtn');

imageUpload.addEventListener('change', async (e)=>{
  predictionDiv.innerHTML = '';
  let file = e.target.files[0];
  if(!file) return;

  let img = document.createElement('img');
  img.src = URL.createObjectURL(file);
  img.style.width = '150px';
  predictionDiv.appendChild(img);

  // Simulated AI prediction
  setTimeout(()=>{
    let confidence = Math.floor(Math.random()*100); // simulate confidence
    let algaeNames = ['Oedogonium','Spirogyra','Cladophora','Cosmarium'];
    let predicted = algaeNames[Math.floor(Math.random()*algaeNames.length)];

    predictionDiv.innerHTML = ''; // clear previous image
    if(confidence < 60){
      predictionDiv.innerHTML = `<p class="text-warning">Algae not yet in our pond. You can kindly <strong>contribute</strong> to help us!</p>`;
    } else {
      let predImg = document.createElement('img');
      predImg.src = `images/${predicted.toLowerCase()}1.jpg`;
      predImg.classList.add('predicted-algae');
      predictionDiv.appendChild(predImg);
      let info = document.createElement('p');
      info.innerHTML = `<strong>${predicted}</strong><br>
                        Habitat: Freshwater ponds<br>
                        Economic Importance: Research, Education`;
      predictionDiv.appendChild(info);
    }
  }, 1000);
});

// Contribute button
contributeBtn.addEventListener('click', ()=>{
  let email = "uniqueseekers123@gmail.com";
  if(window.innerWidth < 768){ // mobile
    window.location.href = `mailto:${email}?subject=Algae Contribution`;
  } else { // desktop
    alert(`Please email your algae data to: ${email}`);
  }
});
