<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Algae Identifier</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- TensorFlow -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(to bottom, #0f9b8e, #38ef7d);
    overflow-x: hidden;
}

/* Bubble background */
body::before {
    content: "";
    position: fixed;
    width: 200%;
    height: 200%;
    background-image: radial-gradient(rgba(255,255,255,0.15) 2px, transparent 2px);
    background-size: 60px 60px;
    animation: bubbles 40s linear infinite;
    z-index: -1;
}

@keyframes bubbles {
    from { transform: translateY(0); }
    to { transform: translateY(-100px); }
}

/* Heading */
h1 {
    text-align: center;
    padding: 30px 10px;
    color: white;
    font-size: 40px;
    letter-spacing: 2px;
}

/* Layout */
.container {
    display: flex;
    justify-content: center;
    gap: 40px;
    padding: 20px;
    flex-wrap: wrap;
}

/* Cards */
.card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}

/* Upload Box */
.upload-box {
    background: #f8f9fa;
    padding: 25px;
    border-radius: 10px;
    text-align: center;
    cursor: pointer;
    transition: 0.3s;
}

.upload-box:hover {
    background: #e3fdfd;
}

.upload-box p {
    margin: 0;
    font-size: 16px;
    color: #333;
}

/* Result Image */
.result-image {
    max-width: 320px;
    width: 100%;
    border-radius: 10px;
    margin-top: 15px;
}

/* Description */
.description {
    margin-top: 20px;
    font-size: 14px;
}

.description h3 {
    margin-bottom: 5px;
}

/* Stars */
.stars {
    font-size: 24px;
    color: gold;
    margin-bottom: 20px;
}

/* Buttons */
button {
    padding: 10px 18px;
    margin: 8px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 14px;
    transition: 0.3s;
}

.contribute {
    background: #27ae60;
    color: white;
}

.explore {
    background: #2980b9;
    color: white;
}

button:hover {
    transform: scale(1.05);
}

/* Responsive */
@media (max-width: 900px) {
    .container {
        flex-direction: column;
        align-items: center;
    }
}
</style>
</head>

<body>

<h1>üåø Algae Identifier</h1>

<div class="container">

    <!-- LEFT SIDE -->
    <div class="card">

        <div class="upload-box" onclick="document.getElementById('imageUpload').click()">
            <p>üåø Select your algae photo to start!</p>
        </div>

        <input type="file" id="imageUpload" accept="image/*" style="display:none;">

        <h2 id="prediction"></h2>
        <img id="resultImage" class="result-image" style="display:none;">
        <div id="description" class="description"></div>

    </div>

    <!-- RIGHT SIDE -->
    <div class="card" style="text-align:center; min-width:250px;">

        <div class="stars">‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê</div>

        <button class="contribute" onclick="alert('Thank you for contributing!')">
            Contribute
        </button>

        <button class="explore" onclick="alert('Explore feature coming soon!')">
            Explore Algae Around the World
        </button>

    </div>

</div>

<script>

let model;

// LOAD MODEL
async function loadModel() {
    try {
        model = await tf.loadLayersModel("my_model/model.json");
        console.log("Model Loaded Successfully");
    } catch (error) {
        console.error("Model failed to load:", error);
        alert("Model not found. Check model/model.json path.");
    }
}

loadModel();

// PREDICTION
document.getElementById("imageUpload").addEventListener("change", async function(event) {

    if (!model) {
        alert("Model is still loading!");
        return;
    }

    const file = event.target.files[0];
    const img = new Image();
    img.src = URL.createObjectURL(file);

    img.onload = async function() {

        const tensor = tf.browser.fromPixels(img)
            .resizeNearestNeighbor([224,224])
            .toFloat()
            .div(255.0)
            .expandDims();

        const prediction = model.predict(tensor);
        const data = await prediction.data();
        const index = data.indexOf(Math.max(...data));

        const classes = ["Cladophora", "Spirogyra"];
        const result = classes[index];

        document.getElementById("prediction").innerText =
            "Prediction: " + result;

        const imageDisplay = document.getElementById("resultImage");
        imageDisplay.src = img.src;
        imageDisplay.style.display = "block";

        showDescription(result);
    };
});

// DESCRIPTION FUNCTION
function showDescription(type) {

    let text = "";

    if (type === "Spirogyra") {
        text = `
        <h3>Habit</h3>
        <ul>
        <li>Filamentous freshwater green algae</li>
        <li>Forms floating slimy masses</li>
        <li>Has spiral chloroplasts</li>
        </ul>

        <h3>Economic Importance</h3>
        <ul>
        <li>Produces oxygen in ponds</li>
        <li>Used in biology studies</li>
        </ul>

        <h3>Location</h3>
        <ul>
        <li>Common in freshwater ponds</li>
        <li>Found in slow-moving water</li>
        </ul>
        `;
    }

    if (type === "Cladophora") {
        text = `
        <h3>Habit</h3>
        <ul>
        <li>Branched filamentous green algae</li>
        <li>Attaches to rocks</li>
        <li>Forms dense mats</li>
        </ul>

        <h3>Economic Importance</h3>
        <ul>
        <li>Provides habitat to aquatic life</li>
        <li>Indicates nutrient pollution</li>
        </ul>

        <h3>Location</h3>
        <ul>
        <li>Freshwater and marine habitats</li>
        <li>Common in nutrient-rich waters</li>
        </ul>
        `;
    }

    document.getElementById("description").innerHTML = text;
}

</script>

</body>
</html>
