<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Pond 2 ‚Ä¢ UniqueSeeker's Algae Pond</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

<style>
  :root{
    /* LOCKED ‚Äúanime pond‚Äù water tones */
    --surfaceA:#69d6b7;
    --surfaceB:#32b99a;

    --underA:#2aa98d;
    --underB:#167d73;

    --glass: rgba(255,255,255,0.14);
    --glass2: rgba(255,255,255,0.10);
    --border: rgba(255,255,255,0.22);
    --text: rgba(255,255,255,0.92);

    --shadow: 0 14px 40px rgba(0,0,0,0.35);
  }

  html, body{
    margin:0;
    height:100%;
    font-family: 'Poppins', system-ui, Arial, sans-serif;
    overflow-x:hidden;
    background: #0b1a17;
  }

  /* Make page scrollable (pond stays fixed) */
  body{
    min-height: 260vh; /* strong scroll */
  }

  /* =============== TOP BAR =============== */
  .topbar{
    position:fixed;
    top:12px; left:12px; right:12px;
    z-index:90;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    pointer-events:none;
  }
  .topbar .pill{
    pointer-events:auto;
    display:flex;
    align-items:center;
    gap:10px;
    padding:10px 14px;
    border-radius:16px;
    background: rgba(0,0,0,0.35);
    border: 1px solid rgba(255,255,255,0.14);
    box-shadow: 0 10px 25px rgba(0,0,0,0.25);
    backdrop-filter: blur(8px);
    color: var(--text);
    font-weight:700;
    font-size:14px;
  }
  .topbar .right{
    pointer-events:auto;
    display:flex;
    gap:8px;
  }
  .btnTiny{
    border:none;
    cursor:pointer;
    padding:10px 12px;
    border-radius:14px;
    background: rgba(255,255,255,0.14);
    border: 1px solid rgba(255,255,255,0.18);
    color: rgba(255,255,255,0.95);
    font-weight:700;
    font-size:13px;
  }
  .btnTiny:active{ transform: scale(0.98); }
  .btnTiny.secondary{ background: rgba(0,0,0,0.25); }

  /* =============== INTRO TEXT (FADE) =============== */
  .intro{
    position:fixed;
    inset:0;
    z-index:85;
    display:flex;
    align-items:flex-start;
    justify-content:center;
    padding-top:82px;
    pointer-events:none;
  }
  .introBox{
    text-align:center;
    max-width: 720px;
    padding: 14px 16px;
    border-radius: 18px;
    background: rgba(0,0,0,0.30);
    border: 1px solid rgba(255,255,255,0.14);
    backdrop-filter: blur(8px);
    color: rgba(255,255,255,0.95);
    box-shadow: 0 18px 55px rgba(0,0,0,0.35);
    animation: introFade 6.5s ease forwards;
  }
  .introBox .line1{ font-size: 20px; font-weight: 800; letter-spacing: 0.3px; }
  .introBox .line2{ margin-top:6px; font-size: 14px; opacity: 0.92; font-weight: 600; }

  @keyframes introFade{
    0%   { opacity:0; transform: translateY(-6px); }
    10%  { opacity:1; transform: translateY(0); }
    70%  { opacity:1; }
    100% { opacity:0; transform: translateY(-8px); }
  }

  /* =============== POND LAYERS (FIXED) =============== */
  #pond-layer{
    position:fixed;
    inset:0;
    z-index:0;
    overflow:hidden;
  }

  /* Surface region */
  .surface{
    position:absolute;
    top:0; left:0; right:0;
    height:34vh;
    background: linear-gradient(to bottom, var(--surfaceA), var(--surfaceB));
  }

  /* Soft shimmer on surface */
  .surface::after{
    content:"";
    position:absolute;
    inset:-40px -60px;
    background:
      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.24), rgba(255,255,255,0) 48%),
      radial-gradient(circle at 70% 45%, rgba(255,255,255,0.18), rgba(255,255,255,0) 55%),
      radial-gradient(circle at 55% 15%, rgba(255,255,255,0.14), rgba(255,255,255,0) 60%);
    filter: blur(1px);
    opacity:0.65;
    animation: shimmer 7s ease-in-out infinite alternate;
    pointer-events:none;
  }
  @keyframes shimmer{
    from { transform: translateX(-10px) translateY(0px); }
    to   { transform: translateX(10px) translateY(-6px); }
  }

  /* Waterline ‚Äî natural */
  .waterline{
    position:absolute;
    top:34vh; left:0; right:0;
    height:44px;
    background:
      linear-gradient(to bottom,
        rgba(255,255,255,0.22),
        rgba(255,255,255,0.10),
        rgba(255,255,255,0.00));
    filter: blur(0.3px);
    opacity:0.85;
    pointer-events:none;
  }
  .waterline::after{
    content:"";
    position:absolute;
    inset:-20px 0 0 0;
    background:
      repeating-linear-gradient(90deg,
        rgba(255,255,255,0.14) 0 22px,
        rgba(255,255,255,0.02) 22px 52px);
    opacity:0.30;
    filter: blur(1px);
    animation: surfaceWaves 4.6s linear infinite;
  }
  @keyframes surfaceWaves{
    from { transform: translateX(0); }
    to   { transform: translateX(120px); }
  }

  /* Underwater region */
  .underwater{
    position:absolute;
    top:34vh; left:0; right:0; bottom:0;
    background: radial-gradient(circle at 50% 0%,
      rgba(255,255,255,0.12),
      rgba(255,255,255,0) 45%),
      linear-gradient(to bottom, var(--underA), var(--underB));
  }

  /* Underwater haze */
  .underwater::before{
    content:"";
    position:absolute;
    inset:0;
    background:
      radial-gradient(circle at 25% 30%, rgba(255,255,255,0.10), rgba(255,255,255,0) 50%),
      radial-gradient(circle at 75% 40%, rgba(255,255,255,0.08), rgba(255,255,255,0) 52%);
    opacity:0.65;
    filter: blur(1px);
    pointer-events:none;
  }

  /* =============== SEAWEED (MORE ‚ÄúLEAFY‚Äù, ANCHORED) =============== */
  .weed{
    position:absolute;
    bottom:-14px;                 /* anchored */
    width:18px;
    height:220px;
    border-radius: 30px;
    background: linear-gradient(to top, rgba(5,45,38,0.95), rgba(34,175,135,0.92));
    transform-origin: bottom center;
    animation: weedSway 3.4s ease-in-out infinite alternate;
    opacity:0.94;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,0.15));
  }
  .weed::before, .weed::after{
    content:"";
    position:absolute;
    bottom:0;
    width:16px;
    height:200px;
    background: inherit;
    border-radius: 30px;
    opacity:0.75;
  }
  .weed::before{ left:-10px; transform: rotate(-6deg); }
  .weed::after { right:-10px; transform: rotate(6deg); }

  @keyframes weedSway{
    from { transform: rotate(-5deg); }
    to   { transform: rotate(6deg); }
  }

  .weed.left{ left: 3.5vw; height:230px; animation-duration:3.2s; }
  .weed.left2{ left: 8.5vw; height:280px; opacity:0.80; animation-duration:4.0s; }
  .weed.left3{ left: 13.5vw; height:210px; opacity:0.70; animation-duration:3.6s; }

  .weed.right{ right: 3.5vw; height:240px; animation-duration:3.4s; }
  .weed.right2{ right: 8.5vw; height:295px; opacity:0.80; animation-duration:4.2s; }
  .weed.right3{ right: 13.5vw; height:220px; opacity:0.70; animation-duration:3.7s; }

  /* =============== LOTUS PAD (SIDE VIEW LIKE IMAGE 2) =============== */
  .pad{
    position:absolute;
    top:16vh;
    left:16vw;
    width: 220px;
    height: 72px;
    border-radius: 999px;
    background:
      radial-gradient(circle at 35% 30%, rgba(255,255,255,0.24), rgba(255,255,255,0) 55%),
      radial-gradient(circle at 70% 80%, rgba(0,0,0,0.18), rgba(0,0,0,0) 55%),
      linear-gradient(to bottom, #94e89b, #49b86a);
    box-shadow: 0 18px 34px rgba(0,0,0,0.20);
    transform: rotate(-8deg);
    animation: padFloat 5.8s ease-in-out infinite alternate;
    pointer-events:none; /* not a button */
  }

  /* underside shadow (gives side-view feel) */
  .pad::after{
    content:"";
    position:absolute;
    left: 10%;
    right: 10%;
    bottom: -10px;
    height: 18px;
    border-radius: 999px;
    background: rgba(0,0,0,0.22);
    filter: blur(8px);
    opacity: 0.55;
  }

  /* slight edge highlight */
  .pad::before{
    content:"";
    position:absolute;
    inset: 6px 10px 14px 10px;
    border-radius: 999px;
    background: rgba(255,255,255,0.12);
    opacity:0.55;
  }

  @keyframes padFloat{
    from { transform: translateY(0) rotate(-8deg); }
    to   { transform: translateY(8px) rotate(-6deg); }
  }

  /* =============== LOTUS FLOWER (BIGGER, KEEP STYLE + INNER WHORLS) =============== */
  .lotus3d{
    position:absolute;
    top: -56px;
    right: -24px;
    width: 148px;
    height: 148px;
    transform: rotate(10deg);
    pointer-events:none;
    filter: drop-shadow(0 14px 18px rgba(0,0,0,0.18));
    animation: lotusBob 4.2s ease-in-out infinite alternate;
  }
  @keyframes lotusBob{
    from { transform: translateY(0) rotate(10deg); }
    to   { transform: translateY(5px) rotate(12deg); }
  }

  /* =============== FROG (SMALLER) =============== */
  .frog{
    position:absolute;
    top:14.2vh;
    left:20.6vw;
    width: 52px;
    height: 34px;
    border-radius: 22px;
    background: linear-gradient(to bottom, #8ef07a, #4bd06b);
    box-shadow: 0 14px 22px rgba(0,0,0,0.18);
    transform: rotate(-2deg);
    animation: frogBob 2.1s ease-in-out infinite;
    pointer-events:none;
  }
  @keyframes frogBob{
    0%,100% { transform: translateY(0) rotate(-2deg); }
    50%     { transform: translateY(-4px) rotate(-1deg); }
  }
  .frog .eye{
    position:absolute;
    top:-8px;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: linear-gradient(to bottom, #a7ff95, #55d86e);
    box-shadow: 0 8px 12px rgba(0,0,0,0.12);
  }
  .frog .eye::after{
    content:"";
    position:absolute;
    inset:4.5px;
    border-radius:50%;
    background: #18241f;
    box-shadow: inset 0 0 0 2px rgba(255,255,255,0.35);
  }
  .frog .eye.left{ left:8px; }
  .frog .eye.right{ right:8px; }

  .frog .mouth{
    position:absolute;
    left: 12px;
    right: 12px;
    bottom: 7px;
    height: 8px;
    border-bottom: 2px solid rgba(0,0,0,0.20);
    border-radius: 0 0 999px 999px;
    opacity:0.75;
  }

  .frog.turn{
    animation: frogBob 2.1s ease-in-out infinite, frogTurn 3.2s ease-in-out infinite;
    transform-origin: 50% 70%;
  }
  @keyframes frogTurn{
    0%, 70% { transform: translateY(0) rotate(-2deg) rotateY(0deg); }
    80%     { transform: translateY(-4px) rotate(-1deg) rotateY(18deg); }
    90%     { transform: translateY(-2px) rotate(-2deg) rotateY(-14deg); }
    100%    { transform: translateY(0) rotate(-2deg) rotateY(0deg); }
  }

  /* ‚úÖ REMOVED RIPPLE COMPLETELY */

  /* =============== FISH (OVAL + BIG TAIL + SHARK FIN + WIGGLE + SMILE) =============== */
  .fish{
    position:absolute;
    width: 52px;
    height: 28px;
    border-radius: 999px;
    top: 42vh;
    left: -140px;

    /* ABOVE UI */
    z-index: 80;

    filter: drop-shadow(0 10px 14px rgba(0,0,0,0.18));
    will-change: transform;
  }

  /* body highlight */
  .fish::before{
    content:"";
    position:absolute;
    inset:5px 8px 11px 8px;
    border-radius: 999px;
    background: rgba(255,255,255,0.18);
    opacity:0.55;
  }

  /* BIG tail (same color) */
  .fish::after{
    content:"";
    position:absolute;
    left:-22px;
    top:4px;
    width: 34px;
    height: 20px;
    background: inherit;
    clip-path: polygon(100% 50%, 0 0, 0 100%);
    border-radius: 8px;
    opacity:0.98;
  }

  /* eye */
  .fish .eye{
    position:absolute;
    right:8px;
    top:9px;
    width: 6px;
    height: 6px;
    background: rgba(0,0,0,0.65);
    border-radius:50%;
    box-shadow: inset 0 0 0 2px rgba(255,255,255,0.42);
  }

  /* small smile mouth */
  .fish .mouth{
    position:absolute;
    right:12px;
    top: 16px;
    width: 10px;
    height: 6px;
    border-bottom: 2px solid rgba(0,0,0,0.35);
    border-radius: 0 0 999px 999px;
    opacity:0.9;
  }

  /* TOP fin: shark style */
  .fish .finTop{
    position:absolute;
    top:-10px;
    left: 18px;
    width: 22px;
    height: 20px;
    background: inherit;
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
    opacity:0.95;
  }

  /* SIDE fin */
  .fish .finSide{
    position:absolute;
    top: 15px;
    left: 18px;
    width: 16px;
    height: 12px;
    background: inherit;
    clip-path: polygon(0% 50%, 100% 0%, 100% 100%);
    opacity:0.92;
  }

  /* BOTTOM fin */
  .fish .finBottom{
    position:absolute;
    bottom: -8px;
    left: 20px;
    width: 16px;
    height: 14px;
    background: inherit;
    clip-path: polygon(50% 100%, 0% 0%, 100% 0%);
    opacity:0.90;
  }

  /* Fish wiggle */
  @keyframes wiggle{
    0%   { transform: translateX(0) rotate(0deg); }
    50%  { transform: translateX(0) rotate(1.8deg); }
    100% { transform: translateX(0) rotate(-1.8deg); }
  }

  /* Fish swim */
  @keyframes swimRight {
    from { transform: translateX(-160px); }
    to   { transform: translateX(calc(100vw + 240px)); }
  }
  @keyframes swimLeft {
    from { transform: translateX(calc(100vw + 240px)) scaleX(-1); }
    to   { transform: translateX(-160px) scaleX(-1); }
  }

  /* Bubble trail (super light) */
  .fish .trail{
    position:absolute;
    left:-18px;
    top: 9px;
    width: 16px;
    height: 10px;
    background:
      radial-gradient(circle at 70% 50%, rgba(255,255,255,0.55), rgba(255,255,255,0.0) 60%),
      radial-gradient(circle at 30% 50%, rgba(255,255,255,0.35), rgba(255,255,255,0.0) 62%);
    opacity:0.75;
    filter: blur(0.2px);
    animation: trailPulse 0.9s ease-in-out infinite alternate;
    pointer-events:none;
  }
  @keyframes trailPulse{
    from { transform: translateX(0); opacity:0.55; }
    to   { transform: translateX(-4px); opacity:0.85; }
  }

  /* =============== BUBBLES (LIGHTWEIGHT) =============== */
  .bubble{
    position:absolute;
    width: 10px;
    height: 10px;
    border-radius:50%;
    background: rgba(255,255,255,0.34);
    border: 1px solid rgba(255,255,255,0.18);
    opacity:0.8;
    filter: none;
    box-shadow: none;
    z-index: 10;
    cursor: pointer;
    will-change: transform, opacity;
    animation: bubbleUp linear forwards;
  }
  @keyframes bubbleUp{
    from { transform: translateY(0) scale(1); opacity:0.65; }
    to   { transform: translateY(-90vh) scale(0.85); opacity:0; }
  }

  /* =============== UI (SCROLLABLE CONTENT) =============== */
  .uiWrap{
    position:relative;
    z-index:30;

    /* push UI lower so it does NOT cover pad/frog */
    padding: 240px 14px 18px;
  }

  .cards{
    display:flex;
    gap:14px;
    justify-content:center;
    align-items:stretch;
    flex-wrap:wrap;
  }

  .card{
    width: min(520px, 94vw);
    background: rgba(255,255,255,0.10);
    border: 1px solid rgba(255,255,255,0.18);
    box-shadow: var(--shadow);
    border-radius: 18px;
    backdrop-filter: blur(10px);
    color: rgba(255,255,255,0.92);
    padding: 16px;
  }
  .card.small{ width: min(420px, 94vw); }

  .uploadBox{
    background: rgba(255,255,255,0.12);
    border: 1px solid rgba(255,255,255,0.14);
    border-radius: 16px;
    padding: 16px;
    text-align:center;
    cursor:pointer;
    user-select:none;
    font-weight:800;
    letter-spacing:0.2px;
  }
  .uploadBox:active{ transform: scale(0.99); }

  #prediction{
    margin: 12px 0 0;
    font-size: 15px;
    font-weight:700;
  }

  .desc{
    margin-top:10px;
    font-size: 13.5px;
    line-height: 1.4;
  }
  .desc h3{
    margin: 10px 0 6px;
    font-size: 13px;
    opacity:0.95;
  }
  .desc ul{ margin: 6px 0 0 18px; padding:0; }

  .stars{
    text-align:center;
    margin-top: 4px;
  }
  .stars span{
    font-size: 28px;
    cursor:pointer;
    color: rgba(255,255,255,0.45);
    transition: transform 0.2s;
    user-select:none;
  }
  .stars span.filled{ color: gold; }
  .stars span:active{ transform: scale(1.05); }

  .thank{
    text-align:center;
    min-height: 24px;
    margin-top: 8px;
    font-weight: 700;
    opacity:0.95;
  }

  .btnRow{
    display:flex;
    gap:10px;
    justify-content:center;
    flex-wrap:wrap;
    margin-top: 10px;
  }
  .btn{
    border:none;
    cursor:pointer;
    padding: 12px 14px;
    border-radius: 14px;
    font-weight: 800;
    letter-spacing: 0.2px;
    color: rgba(255,255,255,0.95);
    background: rgba(255,255,255,0.16);
    border: 1px solid rgba(255,255,255,0.18);
  }
  .btn.green{ background: rgba(49, 190, 120, 0.35); }
  .btn.blue{ background: rgba(58, 152, 255, 0.30); }

  /* Carousel */
  .carousel{
    margin-top: 12px;
    width: 100%;
    max-width: 260px;
    position:relative;
  }
  .carousel img{
    width:100%;
    display:none;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,0.14);
  }
  .carousel img.active{ display:block; }
  .carousel button{
    position:absolute;
    top:50%;
    transform: translateY(-50%);
    border:none;
    background: rgba(0,0,0,0.25);
    border: 1px solid rgba(255,255,255,0.12);
    color:white;
    padding: 6px 10px;
    border-radius: 12px;
    cursor:pointer;
  }
  .prev{ left:8px; }
  .next{ right:8px; }

  /* extra scroll space */
  .scrollSpace{
    height: 95vh;
  }

  @media (max-width: 700px){
    .introBox .line1{ font-size: 18px; }
    .introBox .line2{ font-size: 13px; }

    .pad{ left: 7vw; top: 14.5vh; transform: scale(0.90) rotate(-8deg); }
    .frog{ left: 13.5vw; top: 13.8vh; transform: scale(0.92) rotate(-2deg); }

    .uiWrap{ padding-top: 260px; }
  }
</style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
  <div class="pill">üåø UniqueSeeker‚Äôs Algae Pond ‚Ä¢ Pond 2</div>
  <div class="right">
    <button class="btnTiny secondary" onclick="location.href='index.html'">Pond 1</button>
    <button class="btnTiny" onclick="location.href='pond2.html'">Pond 2</button>
  </div>
</div>

<!-- Intro text -->
<div class="intro">
  <div class="introBox">
    <div class="line1">Welcome to UniqueSeeker‚Äôs Algal Habitat</div>
    <div class="line2">Check if your algae is already in the pond ‚Äî or help the journal grow üåø</div>
  </div>
</div>

<!-- VISUALS -->
<div id="pond-layer">
  <div class="surface"></div>
  <div class="waterline"></div>
  <div class="underwater"></div>

  <!-- Seaweed clusters (anchored bottom/sides) -->
  <div class="weed left"  style="bottom:-18px;"></div>
  <div class="weed left2" style="bottom:-18px;"></div>
  <div class="weed left3" style="bottom:-18px;"></div>

  <div class="weed right"  style="bottom:-18px;"></div>
  <div class="weed right2" style="bottom:-18px;"></div>
  <div class="weed right3" style="bottom:-18px;"></div>

  <!-- Surface objects -->
  <div class="pad">
    <!-- lotus: bigger + inner whorls (clean, single outer whorl) -->
    <svg class="lotus3d" viewBox="0 0 120 120" aria-hidden="true">
      <defs>
        <radialGradient id="p" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#ffe8f3" stop-opacity="0.95"/>
          <stop offset="60%" stop-color="#ffb9d3" stop-opacity="0.95"/>
          <stop offset="100%" stop-color="#ff87b4" stop-opacity="0.95"/>
        </radialGradient>
        <radialGradient id="p2" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#fff0f7" stop-opacity="0.95"/>
          <stop offset="70%" stop-color="#ff9fc6" stop-opacity="0.93"/>
          <stop offset="100%" stop-color="#ff6ea8" stop-opacity="0.92"/>
        </radialGradient>
        <radialGradient id="c" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#ffeaa8" stop-opacity="0.95"/>
          <stop offset="100%" stop-color="#ffcc45" stop-opacity="0.95"/>
        </radialGradient>
      </defs>

      <!-- Outer whorl -->
      <g transform="translate(60 60)">
        <path d="M0,-44 C10,-30 10,-16 0,-6 C-10,-16 -10,-30 0,-44Z" fill="url(#p)"/>
        <path d="M34,-26 C28,-12 16,-4 4,-6 C6,-18 18,-30 34,-26Z" fill="url(#p)" opacity="0.95"/>
        <path d="M44,0 C30,10 16,10 6,2 C16,-10 30,-12 44,0Z" fill="url(#p)" opacity="0.92"/>
        <path d="M34,26 C18,30 6,18 4,6 C16,4 28,12 34,26Z" fill="url(#p)" opacity="0.95"/>
        <path d="M0,44 C-10,30 -10,16 0,6 C10,16 10,30 0,44Z" fill="url(#p)" opacity="0.92"/>
        <path d="M-34,26 C-28,12 -16,4 -4,6 C-6,18 -18,30 -34,26Z" fill="url(#p)" opacity="0.95"/>
        <path d="M-44,0 C-30,-10 -16,-10 -6,-2 C-16,10 -30,12 -44,0Z" fill="url(#p)" opacity="0.92"/>
        <path d="M-34,-26 C-18,-30 -6,-18 -4,-6 C-16,-4 -28,-12 -34,-26Z" fill="url(#p)" opacity="0.95"/>

        <!-- Inner whorl 1 -->
        <g transform="scale(0.72) rotate(18)">
          <path d="M0,-44 C10,-30 10,-16 0,-6 C-10,-16 -10,-30 0,-44Z" fill="url(#p2)" opacity="0.95"/>
          <path d="M34,-26 C28,-12 16,-4 4,-6 C6,-18 18,-30 34,-26Z" fill="url(#p2)" opacity="0.93"/>
          <path d="M44,0 C30,10 16,10 6,2 C16,-10 30,-12 44,0Z" fill="url(#p2)" opacity="0.92"/>
          <path d="M34,26 C18,30 6,18 4,6 C16,4 28,12 34,26Z" fill="url(#p2)" opacity="0.93"/>
          <path d="M0,44 C-10,30 -10,16 0,6 C10,16 10,30 0,44Z" fill="url(#p2)" opacity="0.92"/>
          <path d="M-34,26 C-28,12 -16,4 -4,6 C-6,18 -18,30 -34,26Z" fill="url(#p2)" opacity="0.93"/>
          <path d="M-44,0 C-30,-10 -16,-10 -6,-2 C-16,10 -30,12 -44,0Z" fill="url(#p2)" opacity="0.92"/>
          <path d="M-34,-26 C-18,-30 -6,-18 -4,-6 C-16,-4 -28,-12 -34,-26Z" fill="url(#p2)" opacity="0.93"/>
        </g>

        <!-- Inner whorl 2 (smallest) -->
        <g transform="scale(0.52) rotate(-8)" opacity="0.95">
          <path d="M0,-44 C10,-30 10,-16 0,-6 C-10,-16 -10,-30 0,-44Z" fill="url(#p2)" opacity="0.95"/>
          <path d="M44,0 C30,10 16,10 6,2 C16,-10 30,-12 44,0Z" fill="url(#p2)" opacity="0.92"/>
          <path d="M0,44 C-10,30 -10,16 0,6 C10,16 10,30 0,44Z" fill="url(#p2)" opacity="0.92"/>
          <path d="M-44,0 C-30,-10 -16,-10 -6,-2 C-16,10 -30,12 -44,0Z" fill="url(#p2)" opacity="0.92"/>
        </g>

        <circle r="12" fill="url(#c)"/>
      </g>
    </svg>
  </div>

  <div class="frog turn">
    <div class="eye left"></div>
    <div class="eye right"></div>
    <div class="mouth"></div>
  </div>

  <!-- Fish (above UI) -->
  <div class="fish" id="f1" style="top: calc(34vh + 10vh); background: #ff7b7b;">
    <div class="trail"></div><div class="finTop"></div><div class="finSide"></div><div class="finBottom"></div><div class="eye"></div><div class="mouth"></div>
  </div>
  <div class="fish" id="f2" style="top: calc(34vh + 18vh); background: #ffd16a;">
    <div class="trail"></div><div class="finTop"></div><div class="finSide"></div><div class="finBottom"></div><div class="eye"></div><div class="mouth"></div>
  </div>
  <div class="fish" id="f3" style="top: calc(34vh + 28vh); background: #70d6ff;">
    <div class="trail"></div><div class="finTop"></div><div class="finSide"></div><div class="finBottom"></div><div class="eye"></div><div class="mouth"></div>
  </div>
  <div class="fish" id="f4" style="top: calc(34vh + 38vh); background: #a8ff9c;">
    <div class="trail"></div><div class="finTop"></div><div class="finSide"></div><div class="finBottom"></div><div class="eye"></div><div class="mouth"></div>
  </div>
</div>

<!-- UI -->
<div class="uiWrap">
  <div class="cards">

    <div class="card">
      <div class="uploadBox" id="uploadBox">üåø Select your algae photo to start!</div>
      <input type="file" id="imageUpload" accept="image/*" style="display:none;">
      <div id="prediction"></div>
      <div class="carousel" id="carousel"></div>
      <div id="description" class="desc"></div>
    </div>

    <div class="card small">
      <div class="stars" id="stars"></div>
      <div class="thank" id="thankMessage"></div>

      <div class="btnRow">
        <button class="btn green contribute">Contribute üì®</button>
        <button class="btn blue explore">Explore Algae Around the World üåç</button>
      </div>
    </div>

  </div>

  <div class="scrollSpace"></div>
</div>

<script>
/* ===================== MODEL SETUP ===================== */
let model;
let classes = [];
const CONFIDENCE_THRESHOLD = 0.65;

/* Algae info */
const algaeInfo = {
  "spirogyra": {
    images:["images/spirogyra1.jpg","images/spirogyra2.jpg"],
    habit:["Filamentous freshwater green algae","Forms floating slimy masses","Has spiral chloroplasts"],
    economic:["Produces oxygen in ponds","Used in biological research"],
    location:["Found in freshwater ponds","Common in slow-moving water bodies"]
  },
  "cladophora": {
    images:["images/cladophora1.jpg","images/cladophora2.jpg","images/cladophora3.jpg"],
    habit:["Branched filamentous green algae","Attaches to submerged surfaces","Forms dense green mats"],
    economic:["Provides shelter for aquatic organisms","Indicates nutrient pollution levels"],
    location:["Freshwater & marine habitats","Common in nutrient-rich environments"]
  },
  "oedogonium": {
    images:["images/oedogonium1.jpg","images/oedogonium2.jpg"],
    habit:["Filamentous green algae with basal holdfast","Grows in mats or attached filaments","Prefers calm water"],
    economic:["Used in research and water quality monitoring","Oxygen producer in water bodies"],
    location:["Freshwater ponds and slow streams","Common in nutrient-rich ponds"]
  },
  "volvox": {
    images:["images/volvox1.jpg","images/volvox2.jpg"],
    habit:["Spherical colonial green algae","Colonies with flagella","Forms motile spheres"],
    economic:["Used in biological experiments","Oxygen producer"],
    location:["Freshwater ponds and lakes","Common in nutrient-rich water"]
  },
  "nostoc": {
    images:["images/nostoc1.jpg","images/nostoc2.jpg"],
    habit:["Cyanobacteria forming colonies","Gelatinous colonies","Filamentous structure"],
    economic:["Nitrogen fixation","Used in research"],
    location:["Freshwater and moist soils","Found on rocks and soil surfaces"]
  },
  "pediastrum": {
    images:["images/pediastrum1.jpg","images/pediastrum2.jpg"],
    habit:["Colonial green algae","Flat star-like colonies","Planktonic in water"],
    economic:["Used in ecological studies","Indicator of water quality"],
    location:["Freshwater ponds","Common in nutrient-rich water"]
  },
  "cosmarium": {
    images:["images/cosmarium1.jpg","images/cosmarium2.jpg"],
    habit:["Single-celled green algae with semicells","Desmids are symmetrical","Often found in colonies"],
    economic:["Used in ecological studies","Indicator of water quality"],
    location:["Freshwater habitats","Ponds and lakes with clean water"]
  },
  "noctiluca": {
    images:["images/noctiluca1.jpg","images/noctiluca2.jpg"],
    habit:["Bioluminescent marine plankton","Single-celled","Motile with flagella"],
    economic:["Indicators of marine water health","Can cause red tides"],
    location:["Marine environments","Coastal waters worldwide"]
  },
  "staurastrum": {
    images:["images/staurastrum1.jpg","images/staurastrum2.jpg"],
    habit:["Single-celled desmid","Star-shaped cells","Free-floating"],
    economic:["Used in water quality studies","Indicator species"],
    location:["Freshwater ponds","Clean, slow-moving waters"]
  },
  "scenedesmus": {
    images:["images/scenedesmus1.jpg","images/scenedesmus2.jpg"],
    habit:["Colonial green algae","Forms four-cell colonies","Common planktonic algae"],
    economic:["Used in biofuel research","Indicator of water quality"],
    location:["Freshwater ponds","Often in nutrient-rich waters"]
  }
};

async function loadModel(){
  model = await tf.loadLayersModel("my_model/model.json");
  const metadata = await fetch("my_model/metadata.json").then(res=>res.json());
  classes = metadata.labels.map(l => l.trim().toLowerCase());
}
loadModel();

/* ===================== TOP UI INTERACTIONS ===================== */
const uploadBox = document.getElementById("uploadBox");
const imageUpload = document.getElementById("imageUpload");
uploadBox.addEventListener("click", ()=> imageUpload.click());

/* ===================== FISH ANIMATION (CSS + WIGGLE) ===================== */
function startFish(){
  const f1 = document.getElementById("f1");
  const f2 = document.getElementById("f2");
  const f3 = document.getElementById("f3");
  const f4 = document.getElementById("f4");

  f1.style.animation = "swimRight 15s linear infinite, wiggle 1.3s ease-in-out infinite";
  f2.style.animation = "swimLeft  18s linear infinite, wiggle 1.4s ease-in-out infinite";
  f3.style.animation = "swimRight 21s linear infinite, wiggle 1.25s ease-in-out infinite";
  f4.style.animation = "swimLeft  24s linear infinite, wiggle 1.5s ease-in-out infinite";
}
startFish();

/* ===================== LIGHTWEIGHT BUBBLES ===================== */
const pond = document.getElementById("pond-layer");
const MAX_BUBBLES = 10;

function spawnBubble(){
  const b = document.createElement("div");
  b.className = "bubble";

  const size = 7 + Math.random()*9;
  b.style.width = size+"px";
  b.style.height = size+"px";

  const left = Math.random()*window.innerWidth;
  b.style.left = left+"px";

  const startY = window.innerHeight + 30;
  b.style.top = startY + "px";

  const dur = 7 + Math.random()*6;
  b.style.animationDuration = dur + "s";

  b.style.opacity = (0.40 + Math.random()*0.35).toFixed(2);

  b.addEventListener("pointerdown", ()=> b.remove(), {passive:true});
  b.addEventListener("animationend", ()=> b.remove());

  pond.appendChild(b);
}

setInterval(()=>{
  const existing = pond.querySelectorAll(".bubble").length;
  const needed = MAX_BUBBLES - existing;
  for(let i=0;i<needed;i++) spawnBubble();
}, 900);

/* ===================== STARS ===================== */
const starsContainer = document.getElementById("stars");
const thankMessage = document.getElementById("thankMessage");
let rating = 0;

function renderStars(){
  starsContainer.innerHTML="";
  for(let i=1;i<=5;i++){
    const star = document.createElement("span");
    star.textContent = (i<=rating) ? "‚òÖ" : "‚òÜ";
    if(i<=rating) star.classList.add("filled");
    star.addEventListener("click", ()=>rateStar(i));
    star.addEventListener("touchstart", ()=>rateStar(i), {passive:true});
    starsContainer.appendChild(star);
  }
}
function rateStar(i){
  rating=i;
  renderStars();
  const messages={
    1:"üò¢ We'll improve! Thanks!",
    2:"üôÇ Thank you! We‚Äôll grow!",
    3:"üòä Nice! Thanks!",
    4:"üåü Awesome! You‚Äôre amazing!",
    5:"üòç WOW! You love our pond!"
  };
  thankMessage.textContent = messages[i];
}
renderStars();

/* ===================== CAROUSEL ===================== */
function createCarousel(images){
  const carouselDiv = document.getElementById("carousel");
  carouselDiv.innerHTML="";
  if(!images || images.length===0) return;

  images.forEach((src,i)=>{
    const img = document.createElement("img");
    img.src = src;
    if(i===0) img.classList.add("active");
    carouselDiv.appendChild(img);
  });

  const prevBtn = document.createElement("button");
  prevBtn.className="prev";
  prevBtn.innerHTML="&#10094;";
  prevBtn.onclick=()=>moveSlide(-1);

  const nextBtn = document.createElement("button");
  nextBtn.className="next";
  nextBtn.innerHTML="&#10095;";
  nextBtn.onclick=()=>moveSlide(1);

  carouselDiv.appendChild(prevBtn);
  carouselDiv.appendChild(nextBtn);
  carouselDiv.currentIndex=0;
}
function moveSlide(dir){
  const carouselDiv = document.getElementById("carousel");
  const imgs = carouselDiv.querySelectorAll("img");
  if(!imgs.length) return;
  imgs[carouselDiv.currentIndex].classList.remove("active");
  carouselDiv.currentIndex = (carouselDiv.currentIndex + dir + imgs.length) % imgs.length;
  imgs[carouselDiv.currentIndex].classList.add("active");
}

/* ===================== PREDICTION (PAUSE FISH DURING TFJS) ===================== */
function pausePond(pause){
  const fishes = document.querySelectorAll(".fish");
  fishes.forEach(f=>{
    f.style.animationPlayState = pause ? "paused" : "running";
  });
}

document.getElementById("imageUpload").addEventListener("change", async function(event){
  const file = event.target.files[0];
  if(!file) return;

  pausePond(true);

  const img = new Image();
  img.src = URL.createObjectURL(file);

  img.onload = async function(){
    try{
      const tensor = tf.browser.fromPixels(img)
        .resizeNearestNeighbor([224,224])
        .toFloat()
        .div(255.0)
        .expandDims();

      const prediction = model.predict(tensor);
      const data = await prediction.data();

      const maxValue = Math.max(...data);
      const index = data.indexOf(maxValue);
      const predictedClass = (classes[index] || "").toLowerCase();
      const confidence = (maxValue*100).toFixed(2);

      const predictionText = document.getElementById("prediction");
      const descriptionBox = document.getElementById("description");
      const info = algaeInfo[predictedClass];

      if(predictedClass === "unknown algae"){
        predictionText.innerHTML = "Prediction: <b>Unknown Algae</b>";
        descriptionBox.innerHTML = "<h3>üêüüåø Hmm‚Ä¶ this algae is not yet in our pond!</h3><p>If you know it, please contribute a photo üå±üíö</p>";
        createCarousel([]);
        tensor.dispose(); prediction.dispose();
        pausePond(false);
        return;
      }

      if(maxValue >= CONFIDENCE_THRESHOLD && info){
        predictionText.innerHTML =
          "Prediction: <b>"+predictedClass.charAt(0).toUpperCase()+predictedClass.slice(1)+"</b><br>" +
          "Confidence: "+confidence+"%";

        createCarousel(info.images);

        descriptionBox.innerHTML =
          "<h3>Habit</h3><ul>"+info.habit.map(x=>"<li>"+x+"</li>").join("")+"</ul>"+
          "<h3>Economic Importance</h3><ul>"+info.economic.map(x=>"<li>"+x+"</li>").join("")+"</ul>"+
          "<h3>Location</h3><ul>"+info.location.map(x=>"<li>"+x+"</li>").join("")+"</ul>";
      }else{
        predictionText.innerHTML = "Confidence: "+confidence+"%";
        createCarousel([]);
        descriptionBox.innerHTML =
          "<h3>üêüüåø Oops!</h3><p>Hmm‚Ä¶ this algae is not yet in our pond! If you know it, please contribute üå±üíö</p>";
      }

      tensor.dispose();
      prediction.dispose();
      pausePond(false);
    }catch(err){
      pausePond(false);
      alert("Prediction error: " + err.message);
    }
  };
});

/* ===================== BUTTONS ===================== */
document.querySelector(".contribute").addEventListener("click",()=>{
  const email="uniqueseeekers123@gmail.com";
  const subject=encodeURIComponent("Algae Contribution üåø");
  const body=encodeURIComponent("Hello! I want to contribute an algae image or info to your pond project.");
  if(window.innerWidth>768){
    alert(`üíö Thanks for contributing!\nSend images/info to: ${email}`);
  } else {
    window.location.href=`mailto:${email}?subject=${subject}&body=${body}`;
  }
});

document.querySelector(".explore").addEventListener("click",()=>{
  alert("üåç Global algae exploration coming soon!");
});
</script>

</body>
</html>
